import matplotlib.pyplot as plt
import numpy as np
import requests
from Bio import PDB
from Bio.SVDSuperimposer import SVDSuperimposer
from matplotlib.animation import FuncAnimation
from mpl_toolkits.mplot3d import Axes3D  # Import 3D plotting tools
from scipy.spatial.transform import Rotation
from sklearn.cluster import KMeans
from sklearn.metrics import silhouette_score

list_paths = [r"C:\Users\prone\OneDrive\Desktop\drug_proj\regression\pdb_ids\1.txt",r"C:\Users\prone\OneDrive\Desktop\drug_proj\regression\pdb_ids\2.txt",r"C:\Users\prone\OneDrive\Desktop\drug_proj\regression\pdb_ids\3.txt",r"C:\Users\prone\OneDrive\Desktop\drug_proj\regression\pdb_ids\4.txt",r"C:\Users\prone\OneDrive\Desktop\drug_proj\regression\pdb_ids\5.txt"]
lines = []
for path in list_paths:
    with open(path, 'r') as file:
        lines.append(file.readlines())
pdb_prots = []
for group in lines:
    for indv_prot in group[0].split(','):
        pdb_prots.append(indv_prot)

for pdb_id in pdb_prots:
    if ("/n" or "\n") in pdb_id:
        print(pdb_id) #none exist

example_pocket_coords = [[0.24544734758511477, 0.5984532499131039, 0.6973240982551758], [0.2505729882902029, 0.6039277024678484, 0.7234396881268687], [0.2508924726701949, 0.6363616614529023, 0.7282653949509861], [0.24790598824853102, 0.6534367396593673, 0.710817153022217], [0.2474753788668028, 0.6137904066736183, 0.6847015631505242], [0.2541289883457654, 0.644964372610358, 0.7518261988569698], [0.25479573835618335, 0.6756386861313868, 0.7585443397297604], [0.2718117542470586, 0.6816779631560653, 0.7743650883766701], [0.2802155825033685, 0.6617353145637817, 0.7850194920707013], [0.23726576933227758, 0.6855882864094542, 0.7734377956928202], [0.23571001930796903, 0.6695776850886339, 0.7987964119450436], [0.21997194093706154, 0.6808958985053875, 0.7577684417698044], [0.25669875401091796, 0.6303223844282239, 0.7648082964308694], [0.2773263324582239, 0.709224018074383, 0.7747624995268915], [0.2932449889569529, 0.7190867222801529, 0.789599182468491], [0.3156922393076912, 0.6917361835245046, 0.7657545134552061], [0.2703949104749204, 0.7226929092805003, 0.7639945497899397], [0.3208873331388646, 0.6492005561348627, 0.7279626055031982], [0.3292355988943062, 0.6565432742440042, 0.706199613943454], [0.3162200830659388, 0.6629953076120959, 0.7406608379697969], [0.3192760206136878, 0.7372045533541883, 0.7322773551341735], [0.3049825672653526, 0.7548444560305874, 0.7203171719465578], [0.28816102012751593, 0.7368569690649981, 0.7125014193255363], [0.29159200455612505, 0.7185001737921445, 0.6893758752507475], [0.2987734577933353, 0.7309045881126172, 0.6674614889671094], [0.28759150449361726, 0.6888034410844629, 0.6894704969531811], [0.30195441096803766, 0.7141336461591936, 0.6459066651527194], [0.29073078579266853, 0.6715762947514772, 0.6678399757768441], [0.2978983484046617, 0.6841762252346193, 0.6461337572385603], [0.3158589268102957, 0.7191084462982273, 0.7405851406078499], [0.27460376991568386, 0.8735227667709419, 0.6205858975814693], [0.2685752385714881, 0.8703945081682308, 0.5988039816812384], [0.2437943631842869, 0.9188173444560306, 0.62643351879187], [0.24346098817907796, 0.8156065345846366, 0.5550698308163959], [0.23566834743231793, 0.8174313521028849, 0.5282161916657204], [0.22925087858204496, 0.8261644073687869, 0.574429431134325], [0.2493089413954522, 0.6536322558220368, 0.6308239657847924], [0.24629467572335428, 0.6366440736878692, 0.6483479050755081], [0.2475170507424539, 0.6821776155717761, 0.6330381136217403], [0.24201636315650565, 0.6961896072297531, 0.6565799931872375], [0.2214026753344168, 0.6913885992353145, 0.6619355815449831], [0.20935950327124223, 0.7028806047966633, 0.6486506945232958], [0.2464335819755247, 0.7287973583594022, 0.6548957268839182], [0.2452250975816421, 0.7444603753910324, 0.6802164944551683], [0.2383214568487727, 0.7313825165102538, 0.6989137428560616], [0.2512953008014891, 0.770246784845325, 0.6812762575224254], [0.24967009765109524, 0.6947992700729927, 0.6183717497445214], [0.21715214401800223, 0.6745742092457421, 0.6814276522463192], [0.19767748746371072, 0.669295272853667, 0.6871995760947731], [0.1877456904335264, 0.6939520333680916, 0.7008818742666818], [0.17261879957216872, 0.6898027459158845, 0.7110631694485448], [0.19463544054117873, 0.640206812652068, 0.700295219711593], [0.17925851842591434, 0.6226972540841154, 0.6877483819688883], [0.16647914322623658, 0.6360792492179353, 0.6764694750387948], [0.22722284730035694, 0.6667752867570386, 0.6916278717686688], [0.1966495811976497, 0.7191084462982273, 0.7025472162295143], [0.18756511230570486, 0.7443952033368092, 0.7136747284357141], [0.20101123751580055, 0.7630344108446296, 0.7291926876348359], [0.20162242502535038, 0.7539537712895377, 0.7569168464479014], [0.1874817685544026, 0.742744177963156, 0.766625033117596], [0.2162214721284605, 0.7577337504344802, 0.769160894742818], [0.20958175327471487, 0.7213677441779631, 0.696813141062034], [0.1909266436082288, 0.7367266249565518, 0.6654933575564891], [0.07844036060063062, 0.801268682655544, 0.4269331213807198], [0.08909447014210106, 0.8368091762252344, 0.45656863858294533], [0.06886971982608935, 0.8229275286757038, 0.40931456038757047], [0.05129807892653245, 0.8310523114355229, 0.4189848983762916], [0.18721784667527883, 0.823448905109489, 0.5136066008099618], [0.1932741592699087, 0.8515597844977406, 0.5187540214223534], [0.18264783097887236, 0.8465198123044837, 0.5618447447106468], [0.19094053423344584, 0.8629866180048661, 0.5427311608190454], [0.19674681557416895, 0.891119221411192, 0.5470459104500207], [0.19356586239946658, 0.8978536670142508, 0.5639831951856478], [0.18038365906849466, 0.7300573514077163, 0.3684569092767117], [0.17102137767220899, 0.7596671880431004, 0.3689678664698535], [0.1890652998291453, 0.7241484184914841, 0.3425873358313463], [0.29593977024905893, 0.9240528328119568, 0.2722834109231293], [0.28275756691808696, 0.9195125130344107, 0.2867037583740206], [0.30723284855051325, 0.9761687521724017, 0.2758033382536618], [0.29710658276729035, 0.9121263468891205, 0.2493849589341811], [0.2825492075398313, 0.8927919708029197, 0.24067976231028343], [0.28653581697712216, 0.8607490441432046, 0.24531622572953335], [0.2751732855495826, 0.8423270768161278, 0.2386548578782029], [0.3076634579322415, 0.9157325338894681, 0.23772756519435292], [0.30260727035323853, 0.8540145985401458, 0.2562544945308655], [0.30796905168701644, 0.8239920055613486, 0.2614965368456909], [0.2992318484254976, 0.8116310392770247, 0.2855682979448166], [0.29575919212123736, 0.8275330205074731, 0.30398168123840874], [0.3114972704921448, 0.8693300312825859, 0.26045569811892055], [0.2880082232501285, 0.7686392075078207, 0.30757730593088833], [0.29728716089511187, 0.7718109141466805, 0.3511411377313501], [0.32955508327429817, 0.8539277024678484, 0.35174671662692547], [0.32413773943965213, 0.8508646159193605, 0.37973581620680513], [0.31023322359739414, 0.8368526242613833, 0.38579160516256], [0.3157339111833423, 0.8737400069516857, 0.3380076454335566], [0.3193593643649901, 0.905565693430657, 0.34179251353090345], [0.3363753802558653, 0.9175356273896419, 0.334922977934219], [0.3056909891514217, 0.9235966284323948, 0.35174671662692547], [0.3397924740592574, 0.9471671880431004, 0.33783732636917596], [0.3089136142017752, 0.9532499131039277, 0.3547367624238295], [0.3260407550943868, 0.965067778936392, 0.34775368078422464], [0.3348890833576419, 0.8638338547097669, 0.3971083607736271], [0.3308885832951341, 0.8617700729927006, 0.42432156239355057], [0.31373366115208845, 0.8769551616266943, 0.4358843344309451], [0.31259462988429104, 0.8798227320125129, 0.4589909541652473], [0.3489186148268534, 0.8726755300660409, 0.43620604821921954], [0.35501659929713436, 0.8953771289537712, 0.4178494379470875], [0.3519467711241683, 0.8807134167535626, 0.39262329207827107], [0.3002041921906905, 0.885601320820299, 0.42053669429620383], [0.2837021294328458, 0.9001346889120612, 0.43049089739222585], [0.2663527385367615, 0.8853406326034063, 0.4202906778698762], [0.26519981664374714, 0.8781499826207855, 0.3978653343930964], [0.28363267630676053, 0.9331117483489746, 0.42401877294576285], [0.300718145323721, 0.9477754605491832, 0.4355626206426706], [0.26626939478545925, 0.9479058046576294, 0.43467317663979416], [0.30360739536886555, 0.9787104622871046, 0.4266681806139056], [0.30032920781764383, 0.8810610010427529, 0.40250179781234624], [0.25330944145795997, 0.8796054918317691, 0.4373225843079369], [0.23597394118709283, 0.8650721237400069, 0.430982930244881], [0.22287508160742311, 0.8822992700729927, 0.4138564021043867], [0.21968023780750368, 0.9082377476538059, 0.41771696756368043], [0.22576433165256768, 0.8562521724018074, 0.4555656485371485], [0.20726201886346904, 0.8413277719847062, 0.4512508989061731], [0.20635912822436137, 0.8116093152589502, 0.4463873434010825], [0.19064883110388794, 0.857077685088634, 0.4514779909920139], [0.18948201858565653, 0.7980535279805353, 0.4417319556413459], [0.17363281521301271, 0.8436305179005908, 0.4468793762537375], [0.17316053395563333, 0.8141075773375043, 0.4420347450891336], [0.15636676806823072, 0.8004431699687174, 0.43798493622497253], [0.2554208164909502, 0.8854927007299268, 0.45496006964157293], [0.15847814310122096, 0.7820212026416407, 0.4300367132205442], [0.21534636273978688, 0.8672228015293708, 0.394969910298626], [0.2017752219027378, 0.8791275634341328, 0.3774459710079104], [0.18838465919351027, 0.8543839068474104, 0.3713901820521555], [0.1945243155394424, 0.829683698296837, 0.36792702774308317], [0.21098470642163603, 0.889294403892944, 0.35221982513909383], [0.22290286285785718, 0.9134949600278066, 0.35731047273002536], [0.1962189718159214, 0.8983098713938129, 0.33308731690700577], [0.21859676904057448, 0.8469760166840458, 0.39203663752318235], [0.23523773805058965, 0.9062825860271115, 0.3613602815941864], [0.17039629953744215, 0.8604666319082377, 0.37209038265016464], [0.15654734619605226, 0.8388512339242267, 0.3658075016085689], [0.15131058048922777, 0.8392639902676398, 0.3379697967525832], [0.14907418982928422, 0.8622045533541883, 0.32623670565080803], [0.13883679904432494, 0.8430439694125825, 0.38196888838423976], [0.1233765331777583, 0.8217978797358358, 0.37561030998069717], [0.10883304857551634, 0.8299226624956552, 0.3596003179289201], [0.123612673806448, 0.7932959680222452, 0.3848832368191969], [0.09485907960717307, 0.8102624261383385, 0.35292002573710307], [0.09531747023933546, 0.7820212026416407, 0.3622875742780364], [0.16593740884277197, 0.8798010079944385, 0.37719995458158273], [0.07585670431026098, 0.7709202294056309, 0.3410355399114341], [0.1496575960883999, 0.8129779283976364, 0.3280912910185079], [0.14390687724854495, 0.8072862356621481, 0.30220279323265586], [0.1294745176480393, 0.782955335418839, 0.3045683357934976], [0.11377811115278297, 0.7873653110879387, 0.2948223004428296], [0.16024225250378515, 0.7954249217935347, 0.28543582756140945], [0.17400786209387284, 0.8173879040667362, 0.2804776503538851], [0.15274131488658302, 0.783867744177963, 0.26034215207600014], [0.7158394799349919, 0.5500086896072297, 0.874134211422732], [0.7156727924323874, 0.5339980882864094, 0.8979031830740699], [0.7244099956939062, 0.5041927354883559, 0.8932099466333598], [0.7290633551416149, 0.4969803614876608, 0.8715605011165359], [0.6960592296259255, 0.531760514424748, 0.9094091820900041], [0.6822241669097526, 0.5180309350017379, 0.8917527724158814], [0.6873081357391896, 0.5035844629822732, 0.8733015404413155], [0.6644858385075912, 0.5228319429961765, 0.8968055713258393], [0.7146171049158923, 0.538625304136253, 0.8584080844782559], [0.6551374477365226, 0.5135775112964893, 0.8859808485674273], [0.6616938228389659, 0.5353667014250955, 0.9113583891601378], [0.726757511355586, 0.48722627737226276, 0.9132508232088111], [0.7359808864997013, 0.4591153979840111, 0.9113962378411112], [0.7250628550791071, 0.4339155370177268, 0.9222777336209833], [0.7151449486741398, 0.43736965589155374, 0.9410506793838236], [0.7222569487852648, 0.4939824469933959, 0.9296771507512964], [0.7277159644955619, 0.40834636774417793, 0.91105559971235], [0.7358836521231821, 0.4075643030935002, 0.8964081601756178], [0.890625217041019, 0.26168752172401805, 0.6741607054994133], [0.9034462641163478, 0.25477928397636423, 0.6807463759887967], [0.8799988887499827, 0.2542796315606534, 0.6855910071534006], [0.8893194982706171, 0.25299791449426484, 0.6561068846750692], [0.8417996694031199, 0.35142944038929436, 0.5651565042958252], [0.8312427942381686, 0.33735227667709416, 0.543620604821922], [0.8486755288855551, 0.3286409454292666, 0.5838159040157451], [0.6880026670000416, 0.5120351060132081, 0.7821808409976911], [0.6802239168784987, 0.5078640945429266, 0.8073312895045608], [0.6721395730021809, 0.47764598540145986, 0.8114946444116423], [0.6679584948118515, 0.461722280152937, 0.793289428863404], [0.6654859635232182, 0.5308263816475496, 0.8130653646720412], [0.6510674945479296, 0.5295012165450121, 0.7949926195072102], [0.6704865886013529, 0.47012947514772324, 0.8356610272132017], [0.6629300884832826, 0.44249652415710805, 0.8443662238370993], [0.6446500256976566, 0.449752346193952, 0.8575564891563529], [0.6436360100568126, 0.4713242961418143, 0.871428030733129], [0.6761817449403398, 0.4286148766075773, 0.8637258241550283], [0.6943090108485782, 0.4186001042752867, 0.8526929336512621], [0.7097692767151449, 0.4365875912408759, 0.852787555353696], [0.695892542123321, 0.39098887730274584, 0.8421710003406381], [0.7265630426025476, 0.42726798748696554, 0.8426251845123197], [0.7126585267602895, 0.38145203336809175, 0.8319518564778018], [0.7280076676251198, 0.39963503649635035, 0.8321600242231558], [0.6742231667847369, 0.483554918317692, 0.8488702168729418], [0.6302871192232362, 0.4323079596802224, 0.8530146474395368], [0.6124237751941215, 0.4374131039277024, 0.8650505279890995], [0.6003944937561639, 0.41030152937087244, 0.8636879754740546], [0.6317734161214597, 0.41497219325686474, 0.8422088490216117], [0.5933658373963412, 0.2525634341327772, 0.7315014571742174], [0.609201150143768, 0.2582985749044143, 0.7197305173914689], [0.6263144004111625, 0.26275199860966286, 0.7337913023731122], [0.6317178536205914, 0.29464285714285715, 0.733810226713599], [0.6422747287855426, 0.24539450816823077, 0.7220392869308504], [0.6394827131169174, 0.21276503302050748, 0.718443662238371], [0.6568459946382187, 0.19986096628432393, 0.7063888573483214], [0.6356072286813629, 0.19892683350712545, 0.7437833541501079], [0.6093539470211553, 0.25914581160931527, 0.7012792854169033], [0.6280646191885098, 0.3090241571080987, 0.7126528140494304], [0.6221611034712672, 0.29974800139033714, 0.6980810718746453], [0.6425247600394494, 0.38831682307959675, 0.8142008251012453], [0.6568876665138698, 0.42668143899895716, 0.7797963740963628], [0.6706532761039574, 0.3867744177963156, 0.9137807047424398], [0.6816268700254198, 0.1637990962808481, 0.9165815071344764], [0.6809184481393507, 0.14348713938129995, 0.921085500170319], [0.6868080732313762, 0.280174661105318, 0.7665871844366223], [0.7996138406189662, 0.1374261383385471, 0.7875553536959237], [0.731146948924171, 0.06284758428919011, 0.9477877445971008], [0.7459960272811879, 0.0639120611748349, 0.9728246470610498], [0.7241044019391313, 0.12875825512686825, 0.8115703417735893], [0.7302162770346293, 0.11170490093847758, 0.7955792740622988], [0.7196732924948952, 0.15606534584636775, 0.8062904507777903], [0.7220902612826603, 0.1678832116788321, 0.7810075318875137], [0.7392729646761401, 0.18689172749391725, 0.7806668937587524], [0.7412037615813087, 0.2068126520681265, 0.7962227016388479], [0.7050881360170022, 0.18543621828293358, 0.7729646871806517], [0.6889194482643665, 0.16642770246784844, 0.7655652700503386], [0.6886555263852425, 0.15211157455683003, 0.7422694069111692], [0.6742648386603881, 0.16167014250955855, 0.7822186896786648], [0.67420927615952, 0.13340719499478623, 0.7357972824647061], [0.6598741509355336, 0.1289754953076121, 0.7528481132432534], [0.7518995429984303, 0.18065693430656934, 0.7631240301275501], [0.7690127932658248, 0.1974713242961418, 0.7607963362476817], [0.764276090066814, 0.228449774070212, 0.751958669240377], [0.7571224180800378, 0.23262078554049356, 0.7308769539381552], [0.7822644497228821, 0.18278588807785887, 0.7419476931228948], [0.8011834812684918, 0.19712374000695165, 0.7413231898868325], [0.804267200066675, 0.21752259297879734, 0.727054237159835], [0.8137961689655652, 0.18667448731317343, 0.7569168464479014], [0.7494270117097971, 0.1644073687869308, 0.7514098633662618], [0.8262421691600339, 0.19523375043448035, 0.7569736194693615], [0.8098651220291425, 0.17027285366701425, 0.7675901744824192], [0.8008084343876317, 0.2942735488355926, 0.7117444457060671], [0.7908210748565794, 0.284823600973236, 0.687710533287915], [0.7873900904279701, 0.3025938477580813, 0.6710003406381286], [0.8292564348321317, 0.28052224539450815, 0.6862722834109231], [0.8340070286563598, 0.30570038234271807, 0.67325233715605], [0.8321456848772762, 0.25364963503649635, 0.674690587033042], [0.8415218568987789, 0.30424487313173443, 0.6489534839710837], [0.8396466224944785, 0.2519334376086201, 0.6504106581885621], [0.8443416538178383, 0.2773288147375738, 0.637542106657583], [0.7859315747801808, 0.25697340980187694, 0.685988418303622], [0.7763192621299885, 0.24593760862009034, 0.6636955452102494], [0.7577752774652387, 0.2611444212721585, 0.6590401574505129], [0.7539692461557694, 0.2711374695863747, 0.6379773664887778], [0.7733466683335417, 0.21313434132777195, 0.6657393739828168], [0.7910433248600519, 0.1949078901633646, 0.663373831421975], [0.7866261060410329, 0.16249565519638512, 0.6666288179856932], [0.8000444500006946, 0.2007950990615224, 0.637750274402937], [0.7892653248322706, 0.24376520681265204, 0.6998031868589379], [0.7461904960342264, 0.2631213069169273, 0.6785700768328223], [0.7281604645025073, 0.2773505387556482, 0.6754286363120245], [0.730452417663319, 0.3095672575599583, 0.668407705991446], [0.7215485268991957, 0.319929614181439, 0.6507323719768365], [0.7153671986776124, 0.27307090719499477, 0.6989894402180082], [0.6974760733980637, 0.29066736183524505, 0.6963778812308391], [0.7101859954716562, 0.2411366006256517, 0.7012414367359296], [0.7499270742176105, 0.2552572123740007, 0.6950721017372544], [0.7431206678612604, 0.3245785540493569, 0.6812384088414519], [0.7501076523454321, 0.31512860618700034, 0.6946179175655728], [0.7660957619702463, 0.3407846715328467, 0.6397751788350176], [0.7732077620813713, 0.34276155717761553, 0.6138866810491654], [0.7572891055826423, 0.34074122349669794, 0.5948298701790242], [0.7566362461974414, 0.357533889468196, 0.5766435789712728], [0.7878206998096984, 0.31932134167535625, 0.6090988229060217], [0.7710130432970788, 0.3256864789711505, 0.6509783884031641], [0.74434304288036, 0.32060305874174483, 0.5993527875553537], [0.7279937769999028, 0.3168448036148766, 0.5832103251201696], [0.7158116986845577, 0.3441518943343761, 0.5843079368684001], [0.7167006986984484, 0.29010253736531105, 0.5916505809772529], [0.6983650734119542, 0.2867353145637817, 0.5783278452745921], [0.6952813546137712, 0.2680309350017379, 0.5584005147420612], [0.681737995027156, 0.2995307612095933, 0.582888611331895], [0.677292994957703, 0.2700295446645811, 0.5517959199121911], [0.6683057604422774, 0.28897288842544316, 0.566102721320162], [0.7458849022794516, 0.3077207160236357, 0.6140191514325726], [0.7045047297578865, 0.255387556482447, 0.5505469134400666], [0.7121167923768249, 0.3547097671185262, 0.607301010559782], [0.6630412134850189, 0.3297923183872089, 0.6361417054615646], [0.7167701518245336, 0.34478189085853317, 0.6224026342681956], [0.646469697601089, 0.2849322210636079, 0.4535975171265282], [0.6309955411093053, 0.2680526590198123, 0.46686347980772874], [0.6283146504424164, 0.2765901981230448, 0.49394421104424513], [0.6112847439263241, 0.2812391379909628, 0.5050338745694712], [0.6410245725160089, 0.2821732707681613, 0.5122251239544302], [0.6141601033462516, 0.28936392075078204, 0.5291434843495704], [0.6320790098762346, 0.2903197775460549, 0.5345369213882896], [0.5990332124848939, 0.27941432047271464, 0.4969342568411491], [0.6659165729049464, 0.2517161974278762, 0.43045304871125234], [0.655929213373894, 0.19658063955509208, 0.42895802581280046], [0.6716950729952355, 0.24832725060827252, 0.44691722493471103], [0.7054354016474281, 0.13814303093500171, 0.4322697853979789], [0.7194093706157714, 0.08407194994786235, 0.45948298701790247], [0.7217568862774513, 0.08031369482099408, 0.4822489686234434], [0.7331055270797738, 0.0910453597497393, 0.4438325574353733], [0.7518856523732133, 0.0948905109489051, 0.4530487112524128], [0.7572474337069912, 0.1262599930483142, 0.4576662503311759], [0.7725410120709533, 0.13199513381995134, 0.4666363877218879], [0.7450375741412121, 0.1466371220020855, 0.45132659626812], [0.7491769804558903, 0.1775286757038582, 0.45507361568449334], [0.7451486991429485, 0.18745655196385122, 0.4820786495590628], [0.7332861052075954, 0.17511730969760164, 0.49504182279247566], [0.7381200427831256, 0.1959723670490094, 0.43648991332652054], [0.733161089580642, 0.14131473757386168, 0.4435486923280723], [0.7550943867983498, 0.2097671185262426, 0.4905189054161463], [0.7522606992540735, 0.222041188738269, 0.515650429582529], [0.7330082927032545, 0.23614007646854362, 0.5163506301805382], [0.7242849800669527, 0.23774765380604795, 0.5364104310964762], [0.7672486838632607, 0.2448296836982968, 0.5217251428787706], [0.765345668208526, 0.26196993395898505, 0.5467052723212595], [0.7695961995249405, 0.2428093500173792, 0.5695658756292343], [0.7784028559125445, 0.2881473757386166, 0.546610650618826], [0.7644149963189844, 0.21826120959332637, 0.47944816623140685], [0.726382464474726, 0.24619829683698297, 0.49449301691836034], [0.7080746204386659, 0.25990615224191865, 0.4929412209984482], [0.6919476045616814, 0.23848627042057696, 0.49138942507853606], [0.6759039324359989, 0.24713242961418141, 0.4880776654933575], [0.7070467141726049, 0.2823036148766076, 0.47153779190795203], [0.7193676987401203, 0.30924139728884253, 0.4758525415389273], [0.718937089358392, 0.3233402850191171, 0.5080239203663752], [0.7342723395980053, 0.24578554049356968, 0.4791075281026456], [0.6961842452528788, 0.21050573514077162, 0.49316831308428893], [0.681696323151505, 0.1883689607229753, 0.49318723742477577], [0.6726535261352113, 0.19186652763295098, 0.5194163733393891], [0.6823352919114889, 0.19271376433785192, 0.5386245789334241], [0.6900723701573808, 0.15810740354535974, 0.48998902388251764], [0.6760150574377353, 0.13542752867570385, 0.48347905075508124], [0.6659999166562487, 0.13720889815780327, 0.46105370727830136], [0.672556291758692, 0.11255213764337851, 0.4998296809356194], [0.6527065883235404, 0.11654935696906499, 0.45496006964157293], [0.6592351821755498, 0.09165363225582204, 0.49390636236327157], [0.6493033851453653, 0.09365224191866527, 0.47148101888649185], [0.709116417329944, 0.20433611400764684, 0.49470118466371443], [0.6540539789695934, 0.19364789711505037, 0.5205518337685932], [0.6435387756802933, 0.1974930483142162, 0.5441315620150637], [0.643066494422914, 0.17400938477580813, 0.5648347905075508], [0.630537150477143, 0.17444386513729582, 0.5809394042617615], [0.6240780097512189, 0.20472714633298572, 0.5344612240263427], [0.6225778222277784, 0.1860662148070907, 0.5113735286325272], [0.6413162756455668, 0.1908237747653806, 0.49876991786836233], [0.6563459321304052, 0.15382777198470626, 0.5649483365504713], [0.6565820727590949, 0.1315172054223149, 0.5846485749971614], [0.6756816824325264, 0.13053962460896767, 0.5970629423564588], [0.6899612451556445, 0.13186478971150503, 0.5842700881874265], [0.6507619007931548, 0.10071254779283975, 0.5749025396464933], [0.6652914947701796, 0.08817778936392075, 0.5569622648650694], [0.6317595254962425, 0.1019508168230796, 0.5620718367964876], [0.6607770415746412, 0.05743830378866875, 0.54774611104803], [0.6668194635440541, 0.1544577685088634, 0.5531395480867491], [0.6757928074342626, 0.12956204379562045, 0.6221187691608947], [0.6929616202025253, 0.12877997914494266, 0.6366148139737331], [0.7034490422413913, 0.09995220716023635, 0.6345331365201923], [0.6954619327415927, 0.07679440389294404, 0.6382990802770524], [0.6889611201400175, 0.1353406326034063, 0.6645092918511791], [0.7057687766526372, 0.13312478275981926, 0.6814276522463192], [0.7174646830853856, 0.15680396246089676, 0.6849665039173384], [0.7098804017168813, 0.10744699339589849, 0.6942962037772984], [0.73284160520065, 0.1551094890510949, 0.7008440255857082], [0.7252712144573626, 0.10551355578727842, 0.7104197418719956], [0.7366615271353364, 0.12956204379562045, 0.7136368797547404], [0.751413371115834, 0.1285627389641988, 0.7300064342757656], [0.6639441041241266, 0.12927963156065345, 0.6313349229779341], [0.7524412773818949, 0.10905457073340286, 0.737008440255857], [0.7215485268991957, 0.10216805700382342, 0.6299345217819159], [0.7340084177188815, 0.07722888425443171, 0.6280420877332424], [0.7522745898792904, 0.08667883211678831, 0.6403239847091329], [0.7573724493339445, 0.11218282933611401, 0.6387154157677605], [0.7377311052770485, 0.06860444907890163, 0.5999394421104425], [0.7213818393965913, 0.055635210288494955, 0.5893418114378713], [0.7537608867775138, 0.046989051094890516, 0.598047008061769], [0.7273131363642678, 0.12117657281890858, 0.6272851141137731], [0.7122279173785612, 0.07025547445255474, 0.585310926914197], [0.7616924337764442, 0.06636687521724019, 0.6528518981113508], [0.7794724340542567, 0.07175443169968716, 0.6655501305779493], [0.7932102623939103, 0.048488008342022944, 0.6565421445062639], [0.7905571529774554, 0.022766770941953424, 0.6614813973733015], [0.7767776527621508, 0.06947340980187695, 0.6942583550963247], [0.7938353405286772, 0.076338199513382, 0.7096438439120396], [0.8053506688336042, 0.05424487313173444, 0.7184247378978842], [0.798502590601603, 0.1050139033715676, 0.715661784186821], [0.8209915128279924, 0.0603058741744873, 0.7328072366678021], [0.8142267783472934, 0.1112921445950643, 0.7300821316377123], [0.8254087316470113, 0.0887643378519291, 0.7385413118352825], [0.7566223555722243, 0.04642422662495656, 0.653968434200068], [0.8442999819421871, 0.11470281543274244, 0.7497066727224556], [0.8081843563778806, 0.057546923879040666, 0.6442791718708604], [0.8219360753427511, 0.03708289885297184, 0.6343060444343515], [0.8355211068050172, 0.024070212026416415, 0.6534953256878997], [0.8425080912891888, 0.0, 0.6498618523144468], [0.8332986067702907, 0.051377302745915884, 0.6132811021535899], [0.8427303412926616, 0.07629475147723323, 0.6233677756330191], [0.8206164659471322, 0.060805526590198125, 0.5916695053177397], [0.8100734814073981, 0.07853232533889468, 0.641875780629045], [0.84898112264033, 0.08531021897810219, 0.6092123689489422], [0.8397577474962148, 0.04023288147375739, 0.6734226562204306], [0.8527732633245821, 0.02960983663538407, 0.6923091480261913], [0.8728035448875554, 0.03697427876259993, 0.6858180992392414], [0.8856384825881012, 0.028632255822036833, 0.6995193217516369], [0.8341320442833131, 0.05954553354188392, 0.6753150902691042], [0.8754427636787931, 0.052767639902676404, 0.6650391733848074], [0.8939034045922406, 0.0616093152589503, 0.6562582793989629], [0.8994735453042743, 0.09141466805700382, 0.666931607433481], [0.888249920128905, 0.11157455683003127, 0.6672533212217554], [0.8941534358461474, 0.06267379214459505, 0.6271904924113394], [0.912336264255254, 0.07349235314563782, 0.6158358881192991], [0.9278104207470378, 0.05118178658324643, 0.6183717497445214], [0.9468544679196009, 0.06564998262078554, 0.6187502365542561], [0.9503826867247295, 0.07944473409801876, 0.6438249876991787], [0.8646358572599352, 0.059654153632255826, 0.6555580788009537], [0.9399508271867316, 0.09334810566562392, 0.6496726089095795], [0.948882499201289, 0.062217587765033014, 0.6563339767609098], [0.9637732494339569, 0.0857881473757386, 0.6476855531584724], [0.9169062799516606, 0.09404327424400416, 0.6753529389500775], [0.9240182800627856, 0.12135036496350364, 0.6858748722607017], [0.9242266394410412, 0.14648505387556482, 0.6668937587525074], [0.9223514050367406, 0.1717500868960723, 0.6744256462662277], [0.9438263116222861, 0.11763555787278414, 0.6961129404640247], [0.9470350460474226, 0.08943778241223496, 0.7055940350478785], [0.9240738425636537, 0.07622957942301008, 0.6778509518943265], [0.9427289522301399, 0.08915537017726798, 0.7233829151054085], [0.9266713894792405, 0.13962026416405976, 0.6425570568865675], [0.9276854051200845, 0.16164841849148417, 0.6224972559706294], [0.9100582017196595, 0.1627780674313521, 0.6063547935354452], [0.9035434984928671, 0.1404892248870351, 0.5970629423564588], [0.944451389757053, 0.1559567257559958, 0.6052004087657544], [0.9628009056687642, 0.15921532846715328, 0.6181257333181938], [0.9713714214276784, 0.13668752172401805, 0.6308050414443056], [0.9743301245989082, 0.18230795968022243, 0.6202641837931947], [0.9873178591768416, 0.14583333333333331, 0.640248287347186], [0.9894292342098319, 0.17335766423357662, 0.6341357253699709], [0.9249906238279784, 0.11982968369829683, 0.6367094356761667], [0.9669819838590935, 0.11722280152937087, 0.6305968736989516], [0.9026961703546277, 0.18886861313868614, 0.6027402445024791], [0.8860274200941785, 0.19301790059089327, 0.5876953938155255], [0.8732480448945007, 0.21511122697254084, 0.6006396427084516], [0.8561347946271062, 0.22234532499131035, 0.5856894137239317], [0.8555374977427733, 0.24713242961418141, 0.5705310169940577], [0.8406328568848884, 0.20429266597149806, 0.5864842360243746], [0.8397438568709977, 0.2538451511991658, 0.5563377616290072], [0.8247280910113765, 0.210809871393813, 0.5723477536807843], [0.8243252628800821, 0.23572732012513034, 0.5572082812913969], [0.9089330610770792, 0.20624782759819255, 0.6091934446084554], [0.8821936075342752, 0.19284410844629823, 0.5420688089020097], [0.8850967482046366, 0.20129475147723322, 0.515650429582529], [0.8661638260338097, 0.20918057003823426, 0.5047878581431438], [0.8535372477115195, 0.19097584289190128, 0.504201203588055], [0.8928477170757456, 0.17605144247480012, 0.49998107565951333], [0.8975010765234542, 0.15289363920750781, 0.44977480034820777], [0.8729146698892917, 0.1775069516857838, 0.5451345520608606], [0.8642191385034239, 0.2362486965589155, 0.49642329964800724], [0.8468975288577738, 0.24674139728884253, 0.48544718216570154], [0.8434943256795989, 0.22929701077511294, 0.46129972370462885], [0.8557458571210289, 0.2276894334376086, 0.4451194125884713], [0.8487033101359893, 0.2789146680570038, 0.47842625184512316], [0.8336319817754997, 0.301160062565172, 0.48508761969645353], [0.8145045908516343, 0.28782151546750084, 0.48900495817720746], [0.8749288105457625, 0.24937000347584284, 0.49735059233185724], [0.8274089816782654, 0.21456812652068127, 0.4592748192725483], [0.8233668097401063, 0.19762339242266247, 0.43635744294311346], [0.8230751066105486, 0.21710983663538405, 0.4129480337610234], [0.8181300440332819, 0.24276590198123044, 0.4145566027023958], [0.8041144031892875, 0.1851972540841154, 0.4418455016842663], [0.8045866844466669, 0.18098279457768507, 0.47023201241436735], [0.8132822158325346, 0.20922401807438304, 0.47897505771923843], [0.7813476684585573, 0.28647462634688914, 0.4417319556413459], [0.7692628245197316, 0.26183958985053873, 0.45134552060860683], [0.7527190898862358, 0.2667492179353493, 0.45675788198781264], [0.7762081371282521, 0.2370524852276677, 0.4529730138904659], [0.7861677154088704, 0.2484358706986444, 0.4073842776579237]]

example_pocket_atoms = [['C'], ['C'], ['O'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['N'], ['C'], ['C'], ['C'], ['H'], ['C'], ['N'], ['N'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['O'], ['H'], ['N'], ['C'], ['C'], ['H'], ['O'], ['C'], ['C'], ['C'], ['O'], ['C'], ['C'], ['O'], ['O'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['O'], ['H'], ['N'], ['C'], ['C'], ['C'], ['O'], ['O'], ['H'], ['N'], ['N'], ['C'], ['C'], ['O'], ['H'], ['C'], ['C'], ['C'], ['O'], ['H'], ['N'], ['C'], ['C'], ['H'], ['O'], ['C'], ['C'], ['C'], ['C'], ['O'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['N'], ['C'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['H'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['O'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['O'], ['C'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['O'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['O'], ['C'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['O'], ['N'], ['H'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['H'], ['C'], ['H'], ['H'], ['H'], ['H'], ['N'], ['C'], ['C'], ['H'], ['C'], ['C'], ['O'], ['C'], ['O'], ['H'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['N'], ['O'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['N'], ['C'], ['N'], ['O'], ['C'], ['N'], ['H'], ['C'], ['H'], ['N'], ['O'], ['H'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['O'], ['C'], ['C'], ['O'], ['C'], ['C'], ['O'], ['N'], ['H'], ['H'], ['H'], ['N'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['H'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['N'], ['C'], ['C'], ['O'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['N'], ['C'], ['C'], ['N'], ['H'], ['H'], ['N'], ['C'], ['H'], ['N'], ['C'], ['C'], ['N'], ['C'], ['C'], ['N'], ['H'], ['N'], ['C'], ['C'], ['H'], ['C'], ['O'], ['C'], ['C'], ['C'], ['O'], ['H'], ['C'], ['C'], ['O'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['S'], ['C'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['O'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['O'], ['C'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['O'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['O'], ['C'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['C'], ['N'], ['H'], ['H'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['O'], ['H'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['N'], ['C'], ['C'], ['N'], ['H'], ['H'], ['H'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['H'], ['N'], ['C'], ['C'], ['O'], ['C'], ['C'], ['C'], ['N'], ['C'], ['O'], ['O'], ['H'], ['N']]

#able to input coords of any given pocket as given by the "pocket_finderv2" file

def download_and_format_pdb(pdb_id):

    pdb_url = f"https://files.rcsb.org/view/{pdb_id}.pdb"
    response = requests.get(pdb_url)

    if response.status_code != 200:
        print(f"Failed to download PDB file for {pdb_id}")
        return
    
    pdb_data = response.text.split("\n")
    protein_coords = []
    protein_atoms = []
    ligand_coords = []
    ligand_atoms = []   
    n_ligand = 0
    try:
        for line in pdb_data:
            if line.startswith("ATOM"):
                line = line.split()
                if len(line) == 12:
                    x = float(line[6])
                    y = float(line[7])
                    z = float(line[8])
                    atom = str(line[11])
                elif len(line) == 11:
                    x = float(line[5])
                    y = float(line[6])
                    z = float(line[7])
                    atom = str(line[10])

                protein_coords.append([x,y,z])
                protein_atoms.append([atom])
            elif line.startswith("HETATM"):
                #if "RS1" in line: 
                id = str(line[17:20])
                if id != "HOH": 
                    n_ligand +=1
                    line = line.split()
                    if len(line) == 12:
                        x = float(line[6])
                        y = float(line[7])
                        z = float(line[8])
                        atom = str(line[11])
                    elif len(line) == 11:
                        x = float(line[5])
                        y = float(line[6])
                        z = float(line[7])
                        atom = str(line[10])

                    ligand_coords.append([x,y,z])
                    ligand_atoms.append([atom])
    except ValueError:
        return " ",0,0,0,0

    protein_coords = np.array(protein_coords)
    protein_atoms = np.array(protein_atoms)
    ligand_coords = np.array(ligand_coords)
    ligand_atoms = np.array(ligand_atoms)
    #print(protein_coords.shape)
    #print(protein_atoms.shape)
    #print(ligand_coords.shape)
    #print(ligand_atoms.shape)

    # unique_prot_atoms = np.unique(protein_atoms)
    # unique_ligand_atoms = np.unique(ligand_atoms)

    # protein_atom_type_to_id = {atom_type: idx for idx, atom_type in enumerate(unique_prot_atoms)}
    # ligand_atom_type_to_id = {atom_type: idx for idx, atom_type in enumerate(unique_ligand_atoms)}

    # num_protein_atom_types = len(unique_prot_atoms)
    # num_ligand_atom_types = len(unique_ligand_atoms)

    # protein_atom_types_encoded = np.zeros((len(protein_atoms), num_protein_atom_types))
    # ligand_atom_types_encoded = np.zeros((len(ligand_atoms), num_ligand_atom_types))

    # for i, atom_type in enumerate(protein_atoms):
    #     atom_type_str = atom_type[0]  # Assuming atom_type is a numpy array with a single element
    #     protein_atom_types_encoded[i, protein_atom_type_to_id[atom_type_str]] = 1

    # for i, atom_type in enumerate(ligand_atoms):
    #     atom_type_str = atom_type[0]  # Assuming atom_type is a numpy array with a single element
    #     ligand_atom_types_encoded[i, ligand_atom_type_to_id[atom_type_str]] = 1


    #protein_atoms = protein_atom_types_encoded
    #ligand_atoms = ligand_atom_types_encoded #prot, ligand atoms FIN

    #now process dem coord shits

    min_protein_coords = np.min(protein_coords, axis=0)
    max_protein_coords = np.max(protein_coords, axis=0)

    min_ligand_coords = np.min(ligand_coords, axis=0)
    max_ligand_coords = np.max(ligand_coords, axis=0)

    normalized_protein_coordinates = (protein_coords - min_protein_coords) / (max_protein_coords - min_protein_coords)
    normalized_ligand_coordinates = (ligand_coords - min_ligand_coords) / (max_ligand_coords - min_ligand_coords)

    return normalized_protein_coordinates, normalized_ligand_coordinates, protein_atoms, ligand_atoms, n_ligand


for id in pdb_prots:

    #find its coords and elements
    prot_coords, ligand_coords, prot_atoms, ligand_atoms, n_ligand = download_and_format_pdb(id)
    #calculate RMSD
    coord = []
    atom = []
    total_list = []

    if type(prot_coords) == str: 
        print("NO DATA")

    coords1 = [] #prot+ligand coords 
    for three_coords in prot_coords:
        three_coords = list(three_coords)
        x = three_coords[0]
        y = three_coords[1]
        z = three_coords[2]
        coords1.append([x,y,z])
    # for three_coords in ligand_coords:
    #     three_coords = list(three_coords)
    #     x = three_coords[0]
    #     y = three_coords[1]
    #     z = three_coords[2]
    #     coords1.append([x,y,z])

    coords2 = ligand_coords
    # x1, y1, z1 = zip(*coords1)
    # x2, y2, z2 = zip(*coords2)
    # fig = plt.figure()
    # ax = fig.add_subplot(111, projection='3d')
    # ax.scatter(x1, y1, z1, c='blue', label='Coords 1')
    # ax.scatter(x2, y2, z2, c='red', label='Coords 2')
    # ax.set_xlabel('X Label')
    # ax.set_ylabel('Y Label')
    # ax.set_zlabel('Z Label')
    # ax.legend()

    # plt.show()




    protein_coords = coords1
    protein_elements = prot_atoms
    pocket_coords = example_pocket_coords
    pocket_elements = example_pocket_atoms
    pocket_elements = list(pocket_elements)

    superimposer = SVDSuperimposer()
    protein_coords = np.array(protein_coords)
    pocket_coords = np.array(pocket_coords)
    superimposer.set(protein_coords, pocket_coords)
    superimposer.run()
    transformed_coords = superimposer.transform(pocket_coords)
    print(transformed_coords)
    # p = 0
    # common_elements = []
    # surviving_pocket_index = []
    # surviving_protien_index = []
    # for index in pocket_atom_index:
    #     if protein_elements[index] == pocket_atoms[p]:
    #         common_elements.append(pocket_atoms[p])
    #         surviving_pocket_index.append(p)
    #         surviving_protien_index.append(index)

    # if len(common_elements) == 0:
    #     print('No common elements')
    # else:
    #     print("Num Common Elements: " + str(len(common_elements)))
    # # Extract coordinates of common atoms
    # common_protein_coords =[]
    # common_pocket_coords = []
    # for index in surviving_protien_index:
    #     common_protein_coords.append(protein_coords[index])
    # for index in surviving_pocket_index:
    #     common_pocket_coords.append(pocket_coords[index])

    # common_protein_coords = np.array(common_protein_coords)
    # common_pocket_coords = np.array(common_pocket_coords)
    # covariance_matrix = np.dot(common_protein_coords.T, common_pocket_coords)
    # U, S, Vt = np.linalg.svd(covariance_matrix)
    # rotation_matrix = np.dot(U, Vt)
    # #3x3 rotation matrix
    # aligned_pocket_coords = np.dot(common_pocket_coords, rotation_matrix)
    # fig = plt.figure()
    # ax = fig.add_subplot(111, projection='3d')
    # theta_x = np.arctan2(rotation_matrix[2, 1], rotation_matrix[2, 2])
    # theta_y = np.arctan2(-rotation_matrix[2, 0], np.sqrt(rotation_matrix[2, 1]**2 + rotation_matrix[2, 2]**2))
    # theta_z = np.arctan2(rotation_matrix[1, 0], rotation_matrix[0, 0])
    # ax.quiver(0, 0, 0, 1, 0, 0, color='r', label='X-axis Rotation')
    # ax.quiver(0, 0, 0, 0, 1, 0, color='g', label='Y-axis Rotation')
    # ax.quiver(0, 0, 0, 0, 0, 1, color='b', label='Z-axis Rotation')
    # ax.set_xlabel('X')
    # ax.set_ylabel('Y')
    # ax.set_zlabel('Z')
    # ax.set_xlim([-1, 1])
    # ax.set_ylim([-1, 1])
    # ax.set_zlim([-1, 1])
    # ax.legend()
    # plt.title('Rotation Matrix Visualization')
    # plt.show()

    #downselect prot coords only that align w pocket
    protein_coords = common_protein_coords
    squared_differences = np.sum((aligned_pocket_coords - protein_coords)**2, axis=1)

    mean_squared_difference = np.mean(squared_differences)

    rmsd = np.sqrt(mean_squared_difference)

    print("RMSD:", rmsd)
    print("Length of Overlap (Lower Values Indicate More RMSD Variability): " + str(len(common_elements)))



    #make a list and show top 3